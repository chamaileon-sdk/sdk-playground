{"version":3,"file":"pluginInterface.js","sources":["../src/postMessageSocket.js","../src/updateHooks.js","../src/initPlugin.js","../src/initFullscreenPlugin.js","../src/initInlinePlugin.js","../src/providePlugin.js"],"sourcesContent":["export default class PostMessageSocket {\n\t#currentWindow;\n\t#targetWindow;\n\t#listeners = {};\n\t#msgIdGenerator;\n\t#appliedEventListeners = [];\n\t#isTerminated = false;\n\n\tconstructor(currentWindow, targetWindow) {\n\t\tthis.#currentWindow = currentWindow;\n\t\tthis.#targetWindow = targetWindow;\n\t\tthis.#setupSocket();\n\t}\n\n\tgetDocument() {\n\t\tif (this.#isTerminated) return;\n\t\treturn this.#currentWindow.document;\n\t}\n\n\taddListener(type, callback, { once = false } = {}) {\n\t\tif (this.#isTerminated) return;\n\t\tif (!this.#currentWindow) return;\n\t\tthis.#listeners[type] = { callback, once };\n\t}\n\n\tremoveListener(type) {\n\t\tthis.#listeners[type] = null;\n\t\tdelete this.#listeners[type];\n\t}\n\n\tsendMessage(type, payload) {\n\t\tif (this.#isTerminated) return;\n\t\tif (!this.#targetWindow && this.#isTerminated) return;\n\t\tconst msgId = this.#getNextMsgId();\n\t\tthis.#targetWindow.postMessage(JSON.stringify({ type, payload, msgId, waitForResponse: false }), \"*\");\n\t\treturn this.#waitForResponse(msgId);\n\t}\n\n\tsendRequest(type, payload) {\n\t\tif (this.#isTerminated) return;\n\t\tif (!this.#targetWindow && this.#isTerminated) return;\n\t\tconst msgId = this.#getNextMsgId();\n\t\tthis.#targetWindow.postMessage(JSON.stringify({ type, payload, msgId, waitForResponse: true }), \"*\");\n\t\treturn this.#waitForResponse(msgId);\n\t}\n\n\t#waitForResponse(msgId) {\n\t\tif (this.#isTerminated) return;\n\t\treturn new Promise((resolveWaitForResponse, rejectWaitForResponse) => {\n\t\t\tconst waitForResponse = (event) => {\n\t\t\t\tif (event.source !== this.#targetWindow) return;\n\n\t\t\t\tconst index = this.#appliedEventListeners.findIndex(handler => handler._id === msgId);\n\t\t\t\tif (index === -1) return;\n\t\t\t\tconst listener = this.#appliedEventListeners[index];\n\n\t\t\t\ttry {\n\t\t\t\t\tconst response = this.#tryParse(event);\n\t\t\t\t\tif (response.msgId !== msgId) return;\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tthis.#currentWindow.removeEventListener(\"message\", listener.handler, listener.useCapture);\n\t\t\t\t\tthis.#appliedEventListeners.splice(index, 1);\n\n\t\t\t\t\tif (response.error) {\n\t\t\t\t\t\trejectWaitForResponse(new Error(response.error));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolveWaitForResponse(response.payload);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst handler = waitForResponse.bind(this);\n\t\t\tthis.#currentWindow.addEventListener(\"message\", handler, true);\n\t\t\tthis.#appliedEventListeners.push({ _id: msgId, handler, useCapture: true });\n\t\t});\n\t}\n\n\tasync #onMessage(event) {\n\t\tif (this.#isTerminated) return;\n\t\tif (!!event.source && event.source !== this.#targetWindow) return;\n\t\tlet message;\n\t\ttry {\n\t\t\tmessage = this.#tryParse(event);\n\t\t} catch (error) {\n\t\t\treturn;\n\t\t}\n\t\tif (!message) return; // TODO: We have to renspond with an error or it will timeout\n\n\t\tconst listener = this.#listeners[message.type];\n\t\tif (!listener) return;\n\n\t\tconst respond = ({ error, payload }) => {\n\t\t\tconst response = { msgId: message.msgId };\n\n\t\t\tif (error) {\n\t\t\t\tresponse.error = typeof error === \"string\" ? error : error?.message || \"Unexpected error\";\n\t\t\t} else {\n\t\t\t\tresponse.payload = payload;\n\t\t\t}\n\n\t\t\tthis.#targetWindow.postMessage(JSON.stringify(response), \"*\");\n\t\t};\n\n\t\ttry {\n\t\t\tif (message.waitForResponse) {\n\t\t\t\trespond({ payload: await listener.callback(message.payload) });\n\t\t\t} else {\n\t\t\t\tawait listener.callback(message.payload);\n\t\t\t\trespond({ payload: \"success\" });\n\t\t\t}\n\t\t} catch (error) {\n\t\t\trespond({ error });\n\t\t}\n\n\t\tif (listener.once) {\n\t\t\tthis.removeListener(message.type);\n\t\t}\n\t}\n\n\t#setupSocket() {\n\t\tfunction* msgIdGenerator() {\n\t\t\tlet msgId = 0;\n\t\t\twhile (this.#currentWindow && !this.#isTerminated) {\n\t\t\t\tyield `${msgId++}-${new Date().getTime()}`;\n\t\t\t}\n\t\t}\n\t\tthis.#msgIdGenerator = msgIdGenerator.call(this);\n\n\t\tconst messageHandler = this.#onMessage.bind(this);\n\t\tthis.#currentWindow.addEventListener(\"message\", messageHandler, false);\n\t\tthis.#appliedEventListeners.push({ _id: `START-${new Date().getTime()}`, handler: messageHandler, useCapture: false });\n\t}\n\n\t#tryParse(event) {\n\t\ttry {\n\t\t\treturn JSON.parse(event.data);\n\t\t} catch (err) {\n\t\t\tthrow new Error(err);\n\t\t}\n\t}\n\n\t#getNextMsgId() {\n\t\treturn this.#msgIdGenerator.next().value;\n\t}\n\n\tterminate() {\n\t\tif (!this.#currentWindow) return;\n\t\twhile (this.#appliedEventListeners.length) {\n\t\t\tconst listener = this.#appliedEventListeners.pop();\n\t\t\tthis.#currentWindow.removeEventListener(\"message\", listener.handler, listener.useCapture);\n\t\t}\n\t\tthis.#isTerminated = true;\n\t}\n}\n","export function initUpdateHookList(hooks, messageSocket, validator) {\n\tconst pluginHookList = hooks;\n\tconst currentValidator = validator;\n\tconst currentMessageSocket = messageSocket;\n\n\tif (!pluginHookList.includes(\"error\")) {\n\t\tpluginHookList.push(\"error\");\n\t}\n\n\treturn async function (currentHooks) {\n\t\tif (!currentHooks.includes(\"error\")) {\n\t\t\tcurrentHooks.push(\"error\");\n\t\t}\n\n\t\tif (typeof currentValidator === \"function\") {\n\t\t\tawait currentValidator({ hooks: currentHooks });\n\t\t}\n\n\t\tconst hookFunctions = {};\n\n\t\tcurrentHooks.forEach((hook) => {\n\t\t\tif (!pluginHookList.includes(hook)) {\n\t\t\t\treturn currentMessageSocket.sendMessage(\"error\", `The following hook is not valid: ${hook}`);\n\t\t\t}\n\n\t\t\thookFunctions[hook] = async (payload) => {\n\t\t\t\treturn await currentMessageSocket.sendRequest(hook, payload);\n\t\t\t};\n\t\t});\n\n\t\treturn hookFunctions;\n\t};\n}\n\nexport default function initUpdateHooks(messageSocket) {\n\tconst currentMessageSocket = messageSocket;\n\tlet hooksFromParent = {};\n\n\tcurrentMessageSocket.addListener(\"error\", payload => console.warn(payload));\n\n\treturn function ({ hooks, resetHooks }) {\n\t\tif (resetHooks) {\n\t\t\tObject.keys(hooksFromParent).forEach((hook) => {\n\t\t\t\tcurrentMessageSocket.removeListener(hook);\n\t\t\t});\n\t\t\thooksFromParent = hooks;\n\t\t} else {\n\t\t\thooksFromParent = { ...hooksFromParent, ...hooks };\n\t\t}\n\t\tObject.keys(hooksFromParent).forEach((hook) => {\n\t\t\tif (typeof hooksFromParent[hook] !== \"function\" && hooksFromParent[hook] === null) {\n\t\t\t\tcurrentMessageSocket.removeListener(hook);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcurrentMessageSocket.addListener(hook, payload => hooksFromParent[hook](payload));\n\t\t});\n\n\t\treturn Object.keys(hooksFromParent).filter(hook => typeof hooksFromParent[hook] === \"function\" && hooksFromParent[hook] !== null);\n\t};\n}\n","import PostMessageSocket from \"./postMessageSocket.js\";\nimport initUpdateHooks from \"./updateHooks.js\";\n\nexport function createInitPlugin({ data, settings, hooks }, { container, src, beforeInit, timeout }) {\n\tconst pluginIframe = document.createElement(\"iframe\");\n\n\tpluginIframe.src = src;\n\tpluginIframe.allowFullscreen = \"allowfullscreen\";\n\tpluginIframe.style.width = \"100%\";\n\tpluginIframe.style.height = \"100%\";\n\tpluginIframe.style.border = \"0\";\n\tpluginIframe.style.margin = \"0\";\n\tpluginIframe.style.padding = \"0\";\n\n\tif (typeof beforeInit === \"function\") {\n\t\tbeforeInit({ container, iframe: pluginIframe });\n\t}\n\n\tcontainer.appendChild(pluginIframe);\n\n\treturn initPlugin({ data, settings, hooks }, { currentWindow: window, targetWindow: pluginIframe.contentWindow, timeout, container });\n}\n\nexport default function initPlugin({ data, settings, hooks }, { currentWindow, targetWindow, timeout = null, container }) {\n\tconst messageSocket = new PostMessageSocket(currentWindow, targetWindow);\n\n\tconst updateHooks = initUpdateHooks(messageSocket);\n\tupdateHooks({ hooks });\n\n\treturn new Promise((resolve, reject) => {\n\t\tmessageSocket.addListener(\"domReady\", onDomReady, { once: true });\n\n\t\tlet timeoutId = null;\n\n\t\tif (timeout) {\n\t\t\ttimeoutId = setTimeout(() => {\n\t\t\t\tmessageSocket.terminate();\n\t\t\t\tif (container?.remove && typeof container.remove === \"function\") {\n\t\t\t\t\tcontainer.remove();\n\t\t\t\t}\n\t\t\t\treject(new Error(`Plugin initialization failed with timeout! You can try to increase the timeout value in the plugin settings. Current value is ${timeout}ms.`));\n\t\t\t}, timeout);\n\t\t}\n\n\t\tasync function onDomReady() {\n\t\t\tmessageSocket.sendMessage(\"ackDomReady\", {});\n\t\t\tconst answer = await messageSocket.sendRequest(\"init\", { data, settings, hooks: Object.keys(hooks) });\n\n\t\t\tconst methods = {};\n\n\t\t\tanswer.forEach((type) => {\n\t\t\t\tmethods[type] = async (payload) => {\n\t\t\t\t\tif (type === \"updateHooks\") {\n\t\t\t\t\t\treturn await messageSocket.sendRequest(type, updateHooks(payload));\n\t\t\t\t\t}\n\t\t\t\t\treturn await messageSocket.sendRequest(type, payload);\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tclearTimeout(timeoutId);\n\n\t\t\tresolve({\n\t\t\t\tmethods,\n\t\t\t\tterminate: messageSocket.terminate,\n\t\t\t});\n\t\t}\n\t});\n}\n","import { createInitPlugin } from \"./initPlugin.js\";\n\nlet currentZIndex = 0;\nexport default async function initFullscreenPlugin({ data, settings, hooks }, { id, src, parentElem, beforeInit = null, timeout }) {\n\tlet container = document.createElement(\"div\");\n\tcontainer.id = id;\n\tcontainer.style.position = \"fixed\";\n\tcontainer.style.display = \"flex\";\n\tcontainer.style.top = \"0\";\n\tcontainer.style.left = \"0\";\n\tcontainer.style.zIndex = 0;\n\t// Hide to the top\n\tlet defaultAnimationTime = 500;\n\tlet hiddenPosition = \"translate3d(-100vw, 0px, 0px) scale(1)\";\n\tlet hiddenOpacity = 0;\n\tcontainer.style.transform = hiddenPosition;\n\tcontainer.style.opacity = hiddenOpacity;\n\tcontainer.style.width = \"100%\";\n\tcontainer.style.height = \"100%\";\n\tcontainer.style.border = \"0\";\n\tcontainer.style.margin = \"0\";\n\tcontainer.style.padding = \"0\";\n\tcontainer.style.transition = \"transform 0s\";\n\n\tconst parent = parentElem || document.body;\n\tparent.appendChild(container);\n\n\tlet splashScreen;\n\tfunction showSplashScreen() {\n\t\tif (!settings.splashScreenUrl) return;\n\t\treturn new Promise((resolve) => {\n\t\t\tsplashScreen = document.createElement(\"iframe\");\n\t\t\tsplashScreen.src = settings.splashScreenUrl;\n\n\t\t\tsplashScreen.style.position = \"absolute\";\n\t\t\tsplashScreen.style.top = \"0\";\n\t\t\tsplashScreen.style.left = \"0\";\n\t\t\tsplashScreen.style.width = \"100%\";\n\t\t\tsplashScreen.style.height = \"100%\";\n\t\t\tsplashScreen.style.opacity = \"1\";\n\t\t\tsplashScreen.style.border = \"0\";\n\t\t\tsplashScreen.style.margin = \"0\";\n\t\t\tsplashScreen.style.padding = \"0\";\n\t\t\tsplashScreen.style.transition = \"opacity 0.5s\";\n\t\t\tcontainer.appendChild(splashScreen);\n\t\t\tsplashScreen.addEventListener(\"load\", resolve, { once: true });\n\t\t});\n\t}\n\n\tfunction hideSplashScreen() {\n\t\tif (!splashScreen) {\n\t\t\treturn;\n\t\t}\n\t\tsplashScreen.style.opacity = \"0\";\n\t\tsetTimeout(() => {\n\t\t\tsplashScreen.remove();\n\t\t}, 500);\n\t}\n\n\tlet isVisible = false;\n\tfunction show({ x = \"-100vw\", y = \"0px\", opacity = 0.5, scale = 1, time = defaultAnimationTime } = {}) {\n\t\tif (isVisible) return;\n\t\tif (isNaN(time)) {\n\t\t\tthrow new Error(\"Animation time must be a number!\");\n\t\t}\n\t\tdefaultAnimationTime = time;\n\t\thiddenPosition = `translate3d(${x}, ${y}, 0px) scale(${scale})`;\n\t\thiddenOpacity = opacity;\n\t\tcurrentZIndex++;\n\t\tcontainer.style.zIndex = currentZIndex;\n\t\tcontainer.style.overflow = \"hidden\";\n\n\t\twindow.requestAnimationFrame(() => {\n\t\t\tcontainer.style.transition = \"transform 0s\";\n\t\t\tcontainer.style.transform = `translate3d(${x}, ${y}, 0px) scale(${scale})`;\n\t\t\tcontainer.style.opacity = opacity;\n\t\t\tcontainer.style.display = \"block\";\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\t\tcontainer.style.transition = `all ${time}ms`;\n\t\t\t\t\tcontainer.style.transform = \"translate3d(0px, 0px, 0px) scale(1)\";\n\t\t\t\t\tcontainer.style.opacity = \"1\";\n\t\t\t\t\tisVisible = true;\n\t\t\t\t\tconst transitionEnded = (e) => {\n\t\t\t\t\t\tif (e.propertyName !== \"opacity\" && e.propertyName !== \"transform\") return;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t};\n\t\t\t\t\tcontainer.addEventListener(\"transitionend\", transitionEnded, { once: true });\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction hide() {\n\t\tif (!isVisible) return;\n\t\treturn new Promise((resolve) => {\n\t\t\tcontainer.style.overflow = \"hidden\";\n\t\t\tcontainer.style.transition = `transform ${defaultAnimationTime / 1000}s`;\n\t\t\tcontainer.style.opacity = hiddenOpacity;\n\t\t\tcontainer.style.transform = hiddenPosition;\n\t\t\tisVisible = false;\n\t\t\tif (hiddenOpacity === 0) {\n\t\t\t\tcontainer.style.display = \"none\";\n\t\t\t}\n\t\t\tconst transitionEnded = (e) => {\n\t\t\t\tif (e.propertyName !== \"opacity\" && e.propertyName !== \"transform\") return;\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tcontainer.addEventListener(\"transitionend\", transitionEnded, { once: true });\n\t\t});\n\t}\n\n\tasync function destroy() {\n\t\tawait hide();\n\t\tcontainer.remove();\n\t\tcontainer = null;\n\t}\n\n\tlet _beforeInit = beforeInit;\n\n\tif (!_beforeInit || typeof _beforeInit !== \"function\") {\n\t\t_beforeInit = function ({ iframe }) {\n\t\t\tiframe.style.width = \"100%\";\n\t\t\tiframe.style.height = \"100%\";\n\t\t};\n\t}\n\n\tconst { methods } = await createInitPlugin({ data, settings, hooks }, { container, src, beforeInit, timeout });\n\n\treturn {\n\t\t_container: container,\n\t\t_src: src,\n\t\tmethods,\n\t\tshowSplashScreen,\n\t\thideSplashScreen,\n\t\tshow,\n\t\thide,\n\t\tdestroy,\n\t};\n}\n","import { createInitPlugin } from \"./initPlugin.js\";\n\nexport default async function initInlinePlugin({ data, settings, hooks }, { src, container, beforeInit = null, timeout }) {\n\tconst { methods } = await createInitPlugin({\n\t\tdata,\n\t\tsettings,\n\t\thooks,\n\t}, {\n\t\tcontainer,\n\t\tsrc,\n\t\ttimeout,\n\t\tbeforeInit,\n\t});\n\n\tfunction destroy() {\n\t\twhile (container.firstChild) {\n\t\t\tcontainer.firstChild.remove();\n\t\t}\n\t}\n\n\treturn {\n\t\t_container: container,\n\t\tmethods,\n\t\tdestroy,\n\t};\n}\n","import PostMessageSocket from \"./postMessageSocket.js\";\nimport { initUpdateHookList } from \"./updateHooks.js\";\n\nexport default function providePlugin({ hooks = [], methods = {}, validator = null } = {}, currentWindow = window, targetWindow = window.parent) {\n\tconst messageSocket = new PostMessageSocket(currentWindow, targetWindow);\n\n\tconst updateHooksList = initUpdateHookList(hooks, messageSocket, validator);\n\n\tObject.keys(methods).forEach((methodName) => {\n\t\tif (methodName === \"updateHooks\") {\n\t\t\tmessageSocket.addListener(\"updateHooks\", async payload => await methods.updateHooks(await updateHooksList(payload)));\n\t\t} else {\n\t\t\tmessageSocket.addListener(methodName, payload => methods[methodName](payload));\n\t\t}\n\t});\n\n\tlet ack = false;\n\n\tasync function sendDomReady() {\n\t\tmessageSocket.addListener(\"ackDomReady\", () => {\n\t\t\tack = true;\n\t\t}, { once: true });\n\n\t\twhile (!ack) {\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tmessageSocket.sendMessage(\"domReady\", {});\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tresolve();\n\t\t\t\t}, 200);\n\t\t\t});\n\t\t}\n\t}\n\n\tif (messageSocket.getDocument().readyState === \"loading\") {\n\t\tmessageSocket.getDocument().addEventListener(\"DOMContentLoaded\", sendDomReady, { once: true });\n\t} else {\n\t\tsendDomReady();\n\t}\n\n\treturn new Promise((resolveProvidePlugin, rejectProvidePlugin) => {\n\t\tmessageSocket.addListener(\"init\", onInit, { once: true });\n\n\t\t// eslint-disable-next-line no-shadow\n\t\tasync function onInit({ data = null, settings = null, hooks = [] } = {}) {\n\t\t\tack = true;\n\t\t\ttry {\n\t\t\t\tif (typeof validator === \"function\") {\n\t\t\t\t\tawait validator({ data, settings });\n\t\t\t\t}\n\t\t\t\t// We have to wrap the function to resolve since the\n\t\t\t\t// private field implementation in ES6 doesn't allow\n\t\t\t\t// resolve directly the function. It gives and error.\n\t\t\t\tconst terminate = () => {\n\t\t\t\t\tmessageSocket.terminate();\n\t\t\t\t};\n\n\t\t\t\tresolveProvidePlugin({\n\t\t\t\t\tdata,\n\t\t\t\t\tsettings,\n\t\t\t\t\thooks: await updateHooksList(hooks),\n\t\t\t\t\tterminate,\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\trejectProvidePlugin(error);\n\t\t\t\tthrow new Error(error.message);\n\t\t\t}\n\n\t\t\treturn Object.keys(methods);\n\t\t}\n\t});\n}\n"],"names":["_currentWindow","_targetWindow","_listeners","_msgIdGenerator","_appliedEventListeners","_isTerminated","_PostMessageSocket_instances","waitForResponse_fn","onMessage_fn","setupSocket_fn","tryParse_fn","getNextMsgId_fn","PostMessageSocket","currentWindow","targetWindow","__privateAdd","__privateSet","__privateMethod","__privateGet","type","callback","once","payload","msgId","listener","resolveWaitForResponse","rejectWaitForResponse","handler","event","index","response","error","__async","message","respond","msgIdGenerator","messageHandler","err","initUpdateHookList","hooks","messageSocket","validator","pluginHookList","currentValidator","currentMessageSocket","currentHooks","hookFunctions","hook","initUpdateHooks","hooksFromParent","resetHooks","__spreadValues","createInitPlugin","data","settings","container","src","beforeInit","timeout","pluginIframe","initPlugin","updateHooks","resolve","reject","onDomReady","timeoutId","answer","methods","currentZIndex","initFullscreenPlugin","_0","_1","id","parentElem","defaultAnimationTime","hiddenPosition","hiddenOpacity","splashScreen","showSplashScreen","hideSplashScreen","isVisible","show","y","opacity","scale","time","transitionEnded","e","hide","destroy","initInlinePlugin","providePlugin","updateHooksList","methodName","ack","sendDomReady","resolveProvidePlugin","rejectProvidePlugin","onInit","terminate"],"mappings":"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"}