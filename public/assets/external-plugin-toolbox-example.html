<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0" />
	<title>External Plugin Toolbox Example</title>
</head>

<body>
	<button onclick="change()" type="button">Set align  to left - center</button>

	<pre id="data"></pre>

	<script src="https://cdn.chamaileon.io/plugin-interface/1.1.4/umd/pluginInterface.js"></script>
	<script>
		let interfaceHooks = {};
		let interfaceData = { style: {}, attrs: {}, variables: [], blockLock: false};

		const updateData = (data) => {
			interfaceData.style = data?.elementJson?.style || {};
			interfaceData.attrs = data?.elementJson?.attrs || {};
			interfaceData.variables = data?.variables || [];
			interfaceData.components = data?.components || [];
			interfaceData.blockLock = data?.blockLock || false;
			interfaceData.parentWidth = data?.parentWidth || null;


			document.getElementById("data").innerHTML = JSON.stringify(interfaceData, null, "\t");
		}

		const change = async () => {
			const {style, attrs} = await interfaceHooks?.updateElement({ style: {...(interfaceData.style.align === "center"? {align: "left"}: {align: "center"})}})
			interfaceData.style = style;
			interfaceData.attrs = attrs;

			document.getElementById("data").innerHTML = JSON.stringify(interfaceData, null, "\t");
		}

		const initInterface = async () => {
			const {
				data = {},
				settings = {},
				hooks,
				terminate,
			} = await window.pluginInterface.providePlugin({ hooks: ["updateElement"], methods: {updateData}, validator: () => {}})

			interfaceHooks = hooks;
			interfaceData.style = data?.elementJson?.style || {};
			interfaceData.attrs = data?.elementJson?.attrs || {};
			interfaceData.variables = data?.variables || [];
			interfaceData.components = data?.components || [];
			interfaceData.blockLock = data?.blockLock || false;
			interfaceData.parentWidth = data?.parentWidth || null;


			document.getElementById("data").innerHTML = JSON.stringify(interfaceData, null, "\t");
		}

		document.addEventListener("DOMContentLoaded", (event) => {
			initInterface();
		});

	</script>
</body>
</html>
